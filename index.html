<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Curtains JS - WebGL Product Details</title>
  <link rel="stylesheet" href="./src/css/style.css">
  <script src="./src/js/script.js" defer></script>
</head>
<body>

  <main class="main">
    <section class="wrapper">
      <progress class="progress" value="16" max="100"></progress>
      <div class="canvas"></div>
      <section class="slides multi-textures">
        <img src="./src/img/displacement01.png" data-sampler="displacement">
        <img src="./src/img/model/model-woman-white-01.jpg">
        <img src="./src/img/model/model-woman-white-02.jpg">
        <img src="./src/img/model/model-woman-white-03.jpg">
        <img src="./src/img/model/model-woman-white-04.jpg">
        <nav class="nav">
          <button class="btn" data-goto="prev" type="button">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#242424" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
              <path d="M19 12H6M12 5l-7 7 7 7"/></svg>
          </button>
          <button class="btn" data-goto="next" type="button">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#242424" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
              <path d="M5 12h13M12 5l7 7-7 7"/></svg>
          </button>
        </nav>
      </section>
    </section>
    <section class="content product">
      <h2 class="product__title">Sneakers Peachers</h2>
      <h3 class="product__price">80,30 â‚¬</h3>
      <p class="product__content">Lorem, ipsum dolor sit amet consectetur adipisicing elit. Ipsam, dolor vitae. Reiciendis quidem consequatur maxime incidunt vitae nesciunt et molestiae, aliquid deserunt? Nostrum.</p>
      <h4 class="product__legend-size">Sizes</h4>
      <div class="labels">
        <label class="container">
          <input type="radio" name="size">
          <span class="checkmark">30</span>
        </label>
        <label class="container">
          <input type="radio" name="size" checked>
          <span class="checkmark">31</span>
        </label>
        <label class="container">
          <input type="radio" name="size">
          <span class="checkmark">32</span>
        </label>
        <label class="container">
          <input type="radio" name="size">
          <span class="checkmark">33</span>
        </label>
        <label class="container">
          <input type="radio" name="size">
          <span class="checkmark">34</span>
        </label>
      </div>
      <button class="product__submit marquee" type="submit">
        <span class="mar-default">Add to Cart</span>
        <span class="mar-move">
          <span class="mar-move__txt">Add to cart  -  30% discount if you buy before 12/12/20</span>
          <span class="mar-move__txt">Add to cart  -  30% discount if you buy before 12/12/20</span>
        </span>
      </button>
    </section>
  </main>

  <div class="open-modal">
    <button class="js-open-modal" type="button">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><line x1="4" y1="21" x2="4" y2="14"></line><line x1="4" y1="10" x2="4" y2="3"></line><line x1="12" y1="21" x2="12" y2="12"></line><line x1="12" y1="8" x2="12" y2="3"></line><line x1="20" y1="21" x2="20" y2="16"></line><line x1="20" y1="12" x2="20" y2="3"></line><line x1="1" y1="14" x2="7" y2="14"></line><line x1="9" y1="8" x2="15" y2="8"></line><line x1="17" y1="16" x2="23" y2="16"></line></svg>
    </button>
    <button class="js-close-modal" type="button">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
    </button>
  </div>

  <div class="modal">
    <div class="modal__content">
      <img src="./src/img/displacement01.png" data-setting class="active" alt="">
      <img src="./src/img/displacement02.jpg" data-setting alt="">
      <img src="./src/img/displacement03.jpg" data-setting alt="">
      <img src="./src/img/displacement04.jpg" data-setting alt="">
      <img src="./src/img/displacement05.jpg" data-setting alt="">
      <img src="./src/img/displacement06.jpg" data-setting alt="">
      <img src="./src/img/displacement07.jpg" data-setting alt="">
      <img src="./src/img/displacement08.jpg" data-setting alt="">
      <img src="./src/img/displacement09.jpg" data-setting alt="">
      <img src="./src/img/displacement10.jpg" data-setting alt="">
      <img src="./src/img/displacement11.jpg" data-setting alt="">
      <img src="./src/img/displacement12.jpg" data-setting alt="">
      <img src="./src/img/displacement13.jpg" data-setting alt="">
    </div>
  </div>

  <script id="vs-not-load" type="x-shader/x-vertex">
    precision mediump float;

    attribute vec3 aVertexPosition;
    attribute vec2 aTextureCoord;
    uniform mat4 uMVMatrix;
    uniform mat4 uPMatrix;

    uniform mat4 activeTextureMatrix;
    uniform mat4 nextTextureMatrix;

    varying vec3 vVertexPosition;
    varying vec2 vTextureCoord;
    varying vec2 vActiveTextureCoord;
    varying vec2 vNextTextureCoord;

    uniform float uTransitionTimer;
    void main() {
      gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);

      vTextureCoord = aTextureCoord;
      vActiveTextureCoord = (activeTextureMatrix * vec4(aTextureCoord, 0.0, 1.0)).xy;
      vNextTextureCoord = (nextTextureMatrix * vec4(aTextureCoord, 0.0, 1.0)).xy;

      vVertexPosition = aVertexPosition;
    }
  </script>
  <script id="fs-not-load" type="x-shader/x-fragment">
    precision mediump float;

    varying vec3 vVertexPosition;
    varying vec2 vTextureCoord;
    varying vec2 vActiveTextureCoord;
    varying vec2 vNextTextureCoord;

    uniform float uTransitionTimer;

    uniform sampler2D activeTexture;
    uniform sampler2D nextTexture;
    uniform sampler2D displacement;
    void main() {

      vec4 displacementTexture = texture2D(displacement, vTextureCoord);
      float displacementFactor = (cos(uTransitionTimer / (60.0 / 3.141592)) + 1.0) / 2.0;
      float effectFactor = 1.0;
      
      vec2 firstDisplacementCoords = vec2(vActiveTextureCoord.x - (1.0 - displacementFactor) * (displacementTexture.r * effectFactor), vActiveTextureCoord.y);
      vec2 secondDisplacementCoords = vec2(vNextTextureCoord.x + displacementFactor * (displacementTexture.r * effectFactor), vNextTextureCoord.y);
      vec4 firstDistortedColor = texture2D(activeTexture, firstDisplacementCoords);
      vec4 secondDistortedColor = texture2D(nextTexture, secondDisplacementCoords);
      vec4 finalColor = mix(secondDistortedColor, firstDistortedColor, displacementFactor);

      finalColor = vec4(finalColor.rgb * finalColor.a, finalColor.a);
      gl_FragColor = finalColor;
    }
  </script>

</body>
</html>